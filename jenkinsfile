pipeline {
    agent any

    stages{
        stage("Get repo") {
           steps {
                git url: "https://github.com/Kristijan-web/Exmoor.git",
                branch: "main"
           } 
        }
        stage("Install dependencys") {
            steps {
                dir('client') {
                    bat 'npm install'
                }
            }
         
        }
        stage("Run tests") {
            steps {
                dir('client') {
                    bat "npm test"
                }
                
            }
       
        }
        stage("Build") {
            steps {
                dir('client') {
                    bat "npm run build"
                }
            }
        }
        stage("Deploy on netlify") {
            steps {
                dir('client') {
                    bat "netlify deploy --prod --dir=dist"
                }
            }
        }
    }
}